# MD受信メッセージ
## `Init_with_conf` メッセージドキュメント

### 概要

`Init_with_conf`は、モータードライバの初期化と設定情報を一度に伝えるためのメッセージです。<br>
初期化後にこのメッセージを再送した場合、ACKは帰ってきますが設定した`config_flags`は更新されません。

### メッセージID

- **CAN ID**: `0x01F`

### メッセージ構造

```c
typedef struct {
    uint8_t md_id;           // モータードライバID
    uint8_t config_flags;    // エンコーダの種類と過電流検知の設定情報
    uint8_t data_send_cycle; // モータードライバからのデータ送信周期
} Init_with_conf;
```

### フィールド定義

1. **md_id (1バイト)**
    - モータードライバの固有ID。
    - 範囲: `0x00` ～ `0xFF`

2. **config_flags (1バイト)**
    - エンコーダの種類と過電流検知の設定情報を格納するビット列。

    ```plaintext
    |   bit 7-5  |   bit 4  |  bit 3  |  bit 2   |   bit 1  |   bit 0  |
    |------------|----------|----------|---------|----------|----------|
    |    RSV     |    HB    |   OCD2  -|   OCD1  |   ENC1   |    ENC0  |
    ```

    - **HB**: ハートビート通信の設定
    ```plaintext
    | 0 |ハートビート通信を行う
    | 1 |ハートビート通信を行わない
    ```
    - **ENC[1:0]**: エンコーダの種類を設定するbit

    ```plaintext
    | 0 |エンコーダを使用しない
    | 1 |インクリメンタルエンコーダ
    | 2 |アブソリュートエンコーダ
    ```
    - **OCD1**: 過電流検知1の使用設定
    - **OCD2**: 過電流検知2の使用設定
    ```plaintext
    | 0 |過電流検知時にモーターを停止する(推奨)
    | 1 |過電流検知時にモーターを停止しない
    ```

3. **data_send_cycle (1バイト)**
    - モータードライバからのデータ送信周期を示すバイト。
    - 範囲: `0x00` ～ `0xFF`